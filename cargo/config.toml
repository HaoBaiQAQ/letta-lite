 # ðŸ”§ ç»ˆæžé”å®šï¼šå…¨å±€Cargo configï¼Œå¼ºåˆ¶æ‰€æœ‰ç¼–è¯‘ï¼ˆå«ä¾èµ–åº“ï¼‰ç»§æ‰¿å‚æ•°
- name: Create Cargo configï¼ˆä¾èµ–åº“100%ç»§æ‰¿è·¯å¾„ï¼‰
  run: |
    mkdir -p .cargo
    cat > .cargo/config.toml << EOF
    [build]
    # å…¨å±€å‚æ•°ï¼šä¸»crate + æ‰€æœ‰ä¾èµ–ï¼ˆå«slugï¼‰éƒ½ç»§æ‰¿
    rustflags = [
      "--sysroot=${{ env.NDK_SYSROOT }}",
      "-L", "${{ env.NDK_SYSROOT }}/usr/lib/aarch64-linux-android/24",
      "-L", "${{ env.UNWIND_LIB_PATH }}",
      "-L", "${{ env.OPENSSL_INSTALL_DIR }}/lib",
      "-l:libunwind.a",
      "-l:libdl.so",
      "-l:liblog.so",
      "-l:libm.so",
      "-l:libc.so",
      "-C", "link-arg=--allow-shlib-undefined",
      "-C", "linker=${{ env.NDK_TOOLCHAIN_BIN }}/ld.lld"
    ]

    [target.aarch64-linux-android]
    # ç›®æ ‡æž¶æž„å…œåº•ï¼šé¿å…äº¤å‰ç¼–è¯‘åœºæ™¯é—æ¼
    linker = "${{ env.NDK_TOOLCHAIN_BIN }}/ld.lld"
    rustflags = [
      "--sysroot=${{ env.NDK_SYSROOT }}",
      "-L", "${{ env.NDK_SYSROOT }}/usr/lib/aarch64-linux-android/24",
      "-L", "${{ env.UNWIND_LIB_PATH }}",
      "-L", "${{ env.OPENSSL_INSTALL_DIR }}/lib",
      "-l:libunwind.a",
      "-l:libdl.so",
      "-l:liblog.so",
      "-l:libm.so",
      "-l:libc.so",
      "-C", "link-arg=--allow-shlib-undefined"
    ]
    EOF
